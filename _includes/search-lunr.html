<!-- Lunr.js Search Interface -->
<section id="search-section" class="bg-light p-4">
  <h3>Ricerca Progetti</h3>
<input type="text" id="search-input" placeholder="Ricerca per qualsiasi campo (titolo, anno, studente, descrizione...)" style="width: 100%; padding: 10px; margin-bottom: 20px; font-size: 16px;">
<div id="search-results"></div>
</section>

<!-- Lunr.js CDN -->
<script src="{{ site.baseurl }}/assets/js/lunr.js"></script>

<script>
  fetch('{{ site.baseurl }}/assets/search.json')
    .then(response => response.json())
    .then(data => {
      const idx = lunr(function () {
        this.ref('id');
        this.field('title');
        this.field('description');
        this.field('students');
        this.field('year');
        data.forEach(doc => this.add(doc));
      });

      document.getElementById('search-input').addEventListener('input', function () {
        const query = this.value;
        const results = idx.search(query);
        const container = document.getElementById('search-results');
        container.innerHTML = '';

        if (results.length === 0) {
          container.innerHTML = '<p>No results found</p>';
          return;
        }

        results.forEach(result => {
          const item = data.find(d => d.id === result.ref);
          const el = document.createElement('div');
          el.innerHTML = `
            <div style="display: flex; align-items: center; gap: 1em;">
<img src="{{ site.baseurl }}${item.img_url}" alt="Thumbnail" style="max-width: 25%; height: auto; object-fit: cover; border-radius: 6px; ">              <div style="flex: 1;">
                <h2><a href="${item.url}" target="_blank">${item.title}</a></h2>
                <p>${item.description}</p>
                <p>${item.year} | <small><strong>Students:</strong> ${item.students}</small></p>
              </div>
            </div>
            <hr>
          `;
          container.appendChild(el);
        });
      });
    });
</script>